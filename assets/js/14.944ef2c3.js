(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{443:function(a,t,s){"use strict";s.r(t);var e=s(12),n=Object(e.a)({},(function(){var a=this,t=a.$createElement,s=a._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h2",{attrs:{id:"前言"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#前言"}},[a._v("#")]),a._v(" 前言")]),a._v(" "),s("p",[a._v("@Data相当于@Getter @Setter @RequiredArgsConstructor @ToString @EqualsAndHashCode这5个注解的合集。所以可知，当使用@Data注解时，则有了@EqualsAndHashCode注解，那么编译后就会自动重写equals() 和 hashCode()方法。"),s("strong",[a._v("用在一般的普通实体类不会出现什么问题，但是当用来派生类上时，可能会导致不必要的错误。")])]),a._v(" "),s("p",[a._v("首先明白一个问题“"),s("strong",[a._v("为什么要重写hashcode和equals方法？")]),a._v("”")]),a._v(" "),s("p",[s("a",{attrs:{href:"https://www.yuque.com/weig/backend/frle7h?view=doc_embed",target:"_blank",rel:"noopener noreferrer"}},[a._v("为什么重写equals一定要重写hashcode"),s("OutboundLink")],1)]),a._v(" "),s("h2",{attrs:{id:"场景"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#场景"}},[a._v("#")]),a._v(" 场景")]),a._v(" "),s("p",[a._v("在比较两个类的时候，如果多个类有相同的部分属性，把它们定义到父类中，恰好id（数据库主键）也在父类中。")]),a._v(" "),s("p",[a._v("定义一个公共父类BaseEntity")]),a._v(" "),s("p",[s("img",{attrs:{src:"https://weig-blog-wggz.oss-cn-beijing.aliyuncs.com/img/1642406186104-1a2fe6c5-f0e9-4208-8550-6d90b83e7f7e.png",alt:"image.png"}})]),a._v(" "),s("p",[a._v("定义一个派生子类User")]),a._v(" "),s("p",[s("img",{attrs:{src:"https://weig-blog-wggz.oss-cn-beijing.aliyuncs.com/img/1642406234015-d9f1f4fb-549f-4923-a5d2-c86f26b16859.png",alt:"image.png"}})]),a._v(" "),s("p",[a._v("此时发现@Data注解处出现警告")]),a._v(" "),s("p",[s("img",{attrs:{src:"https://weig-blog-wggz.oss-cn-beijing.aliyuncs.com/img/1642405275875-a9e2099e-0e77-466d-a6c4-b0182ac20018.png",alt:"image.png"}})]),a._v(" "),s("p",[a._v("大致意思是默认重写生成子类的equals和hashCode方法，不会包含或者考虑父类的属性。如果这是我们想要的操作，建议加上"),s("code",[a._v("@EqualsAndHashCode(callSuper = false)")]),a._v("注解。")]),a._v(" "),s("p",[a._v("也就是说，"),s("strong",[a._v("@Data注解在派生子类上时默认@EqualsAndHashCode(callSuper = false)，即重写子类的equals和hashcode不包含父类")])]),a._v(" "),s("p",[a._v("添加注解"),s("code",[a._v("@EqualsAndHashCode(callSuper = false)")]),a._v("，报警消失")]),a._v(" "),s("p",[s("img",{attrs:{src:"https://weig-blog-wggz.oss-cn-beijing.aliyuncs.com/img/1642406397731-05b16f58-ec7e-41ce-8525-6f1094d2fbec.png",alt:"image.png"}})]),a._v(" "),s("p",[a._v("进行测试")]),a._v(" "),s("p",[s("img",{attrs:{src:"https://weig-blog-wggz.oss-cn-beijing.aliyuncs.com/img/1642406779324-aceb0c43-8112-46f7-869b-2ed29d6ddacb.png",alt:"image.png"}})]),a._v(" "),s("p",[a._v("结果：true，true")]),a._v(" "),s("p",[a._v("当更改注解为"),s("code",[a._v("@EqualsAndHashCode(callSuper = true)")]),a._v("时，进行测试，结果：false，false")]),a._v(" "),s("p",[a._v("经过上述讲解，出现这个结果毫不吃惊，因为字段id，IdentityNo是父类的属性\n​")]),a._v(" "),s("h2",{attrs:{id:"分析"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#分析"}},[a._v("#")]),a._v(" 分析")]),a._v(" "),s("p",[a._v("当@Data注解在派生子类User上时，默认等同于"),s("code",[a._v("@EqualsAndHashCode(callSuper = false)")])]),a._v(" "),s("p",[a._v("通过反编译工具查看项目target/classes目录下的User.class的equals和hashcode方法，默认情况下属性都是使用的他自身的属性。")]),a._v(" "),s("p",[s("img",{attrs:{src:"https://weig-blog-wggz.oss-cn-beijing.aliyuncs.com/img/1642407291874-8a29b256-51a6-41cb-8b07-f6a127d65afa.png",alt:"image.png"}}),a._v(" "),s("img",{attrs:{src:"https://weig-blog-wggz.oss-cn-beijing.aliyuncs.com/img/1642407346263-e4a52365-3948-44de-a9b1-254c27a2f08c.png",alt:"image.png"}}),a._v("\n​")]),a._v(" "),s("p",[a._v("当"),s("code",[a._v("@EqualsAndHashCode(callSuper = true)")]),a._v("时")]),a._v(" "),s("p",[a._v("反编译工具查看User.class的equals和hashcode方法")]),a._v(" "),s("p",[s("img",{attrs:{src:"https://weig-blog-wggz.oss-cn-beijing.aliyuncs.com/img/1642407574595-110ed304-8a0a-43fd-b91e-23b8d120ca3b.png",alt:"image.png"}}),a._v(" "),s("img",{attrs:{src:"https://weig-blog-wggz.oss-cn-beijing.aliyuncs.com/img/1642407598237-199797be-fce2-4a6e-9800-9d3710abb1b6.png",alt:"image.png"}})]),a._v(" "),s("h2",{attrs:{id:"补充"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#补充"}},[a._v("#")]),a._v(" 补充")]),a._v(" "),s("p",[a._v("每一个继承的类，都需要这么来解决，也不是很方便。在stackoverflow上，有人提出这个问题："),s("a",{attrs:{href:"https://stackoverflow.com/questions/38572566/warning-equals-hashcode-on-data-annotation-lombok-with-inheritance",target:"_blank",rel:"noopener noreferrer"}},[a._v("这里"),s("OutboundLink")],1)]),a._v(" "),s("p",[a._v("解决办法就是通过设置 lombok 全局属性，在src/main/java 目录下创建 lombok.config 文件来解决")]),a._v(" "),s("p",[a._v("⚠️ 注：一定要在src/main/java 目录下创建才有效")]),a._v(" "),s("p",[a._v("配置pom.xml添加插件依赖")]),a._v(" "),s("div",{staticClass:"language-xml line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-xml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("plugin")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n  \t"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("groupId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("org.apache.maven.plugins"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("groupId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n  \t"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("artifactId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("maven-compiler-plugin"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("artifactId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n  \t"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("configuration")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n  \t\t"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("source")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("1.8"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("source")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n  \t\t"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("target")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("1.8"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("target")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n  \t"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("configuration")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("plugin")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br")])]),s("p",[a._v("新建lombok.config文件")]),a._v(" "),s("div",{staticClass:"language-properties line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-properties"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 声明该配置文件是一个根配置文件，从该配置文件所在的目录开始扫描")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[a._v("config.stopBubbling")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[a._v("true")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 全局配置 equalsAndHashCode 的 callSuper 属性为true")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[a._v("lombok.equalsAndHashCode.callSuper")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[a._v("call")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br")])]),s("h2",{attrs:{id:"总结"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#总结"}},[a._v("#")]),a._v(" 总结")]),a._v(" "),s("ol",[s("li",[a._v("如果比较两个对象时需要考虑父类（基类，超类）中的成员，使用"),s("code",[a._v("@EqualsAndHashCode(callSuper=true)")]),a._v("，才能正确比较")]),a._v(" "),s("li",[a._v("如果只是想在当前类比较字段，使用"),s("code",[a._v("@EqualsAndHashCode(callSuper=false)")]),a._v("，或者不使用，它是默认选项")]),a._v(" "),s("li",[a._v("如果全部要比较 或 全部不需要比较 父类成员，使用全局配置 lombok.config")])]),a._v(" "),s("blockquote",[s("p",[a._v("参考\n"),s("a",{attrs:{href:"https://blog.csdn.net/feinifi/article/details/85275280",target:"_blank",rel:"noopener noreferrer"}},[a._v("https://blog.csdn.net/feinifi/article/details/85275280"),s("OutboundLink")],1)]),a._v(" "),s("p",[s("a",{attrs:{href:"https://www.cnblogs.com/lwcode6/p/12970582.html",target:"_blank",rel:"noopener noreferrer"}},[a._v("https://www.cnblogs.com/lwcode6/p/12970582.html"),s("OutboundLink")],1)]),a._v(" "),s("p",[s("a",{attrs:{href:"https://www.cnblogs.com/binyue-sunmk/p/12632037.html",target:"_blank",rel:"noopener noreferrer"}},[a._v("https://www.cnblogs.com/binyue-sunmk/p/12632037.html"),s("OutboundLink")],1)]),a._v(" "),s("p",[s("a",{attrs:{href:"https://www.freesion.com/article/69941080555/",target:"_blank",rel:"noopener noreferrer"}},[a._v("https://www.freesion.com/article/69941080555/"),s("OutboundLink")],1)])])])}),[],!1,null,null,null);t.default=n.exports}}]);